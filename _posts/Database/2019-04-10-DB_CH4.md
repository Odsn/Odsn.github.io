---
layout: post
title: DB Chapter 4
published: True
category: Database
permalink: /Database/:year/:month/:day/:title/
---

## Ch.4:High-Level Database Models

----

### 1.The Entity/Relationship Model

E/R Model(Diagram)은 High-Level Design의 가장 대표적인 모델이다. 기본적으로 DB Modeling은 High-Level Design, Relational DB Schema, Relational DBMS 3가지를 통해 구현한다.

![DB4_1](https://user-images.githubusercontent.com/43085342/55796658-7658b580-5b05-11e9-8e6c-a7d3bd7349e9.PNG)

- Rectangle : Entity(table)
- Diamond: Relationship between entity
  - 어떻게 Relationship을 만들 것인가? 2개의 entity에서 모든 information을 가져올 필요 없이 각 entity의 primary key만을 가져오면 모든 정보에 접근 가능.
  - Relationship의 key의 설정은 지난 chapter에서 다뤘다.
- Oval: Attribute
- Multiplicity Relationship(Many:Many, Many:1, 1:1)
- Arrow: M:1일때(Many to 1) 화살표가 가리키는 곳이 1
  - Round arrow: exactly one
  - Arrow pointing to: at most one(0 or 1)

**Multiway Relationship**

entity가 3개 이상인 relationship. 아래는 three-way relationship의 예시다. figure 2를 아래와 같이 표현할 수 있다.

![DB4_2](https://user-images.githubusercontent.com/43085342/55797421-56c28c80-5b07-11e9-8bb1-ca2d794913dc.PNG)

위 그림에서 Movie를 예능이라고 생각하고 star에 해당하는 사람 중 유재석이 있다고 예를 들자. 그리고 그는 아래와 같이 계약을 맺었다.

1. 유재석, 무한도전, MBC
2. 유재석, 놀러와, MBC
3. 유재석, 런닝맨, SBS
4. 유재석, 해피투게더, KBS

특정한 star가 특정한 예능을 찍기 위해 특정한 studio와 계약을 했다. 그러면 Relationship인 Contract는 3가지의 entity에 영향을 받게 된다. 그리고 사람과 예능이 정해지면 studio는 자동으로 정해지기 때문에 studio쪽으로 arrow가 있다.

**Roles in Relationship**

하나의 entity의 정보에 따라 해석이(?) 다르면 그거도 way로 친다. 어려우니까 예시를 하나 들자. 아래의 그림에서 영화의 경우 첫 영화 다음 속편이 있는 경우가 있다. 그래서 original 영화와 sequel 영화의 접근이 relationship에게는 다른 것이다. 이 경우 2-way relationship이 된다.

![DB4_4](https://user-images.githubusercontent.com/43085342/55798429-d9e4e200-5b09-11e9-9852-7cee90dfcf4f.png)

뭔가 이해하기 어려우니까 예시를 하나 더 봅시다ㅏㅏ

![DB4_3](https://user-images.githubusercontent.com/43085342/55798134-2b40a180-5b09-11e9-869d-503f2be7de39.PNG)

교수님께서는 이거도 유재석을 예시로 설명해 주셨다. 유재석이 KBS와 전속계약을 맺었는데 MBC가 유재석과 무한도전이라는 프로그램을 하고 싶어한다. 그 경우 KBS가 허락을 해줘서 유재석은 MBC와 무한도전이라는 프로그램으로 계약을 하게 된다. 다른 프로그램의 경우 다 KBS지만 무한도전의 경우는 MBC인 것이다.

**Attributes on Relationships**

Relationship에도 attribute가 붙을 수 있다. attribute는 entity로 연결되는 것보다 attribute 자체가 relationship에 붙어 있는 것이 더 좋을 경우 붙인다. 아래 그림에서는 salary는 따로 entity를 만드는 것보다 attribute를 contract에 붙이는 것이 더 낫다. studio의 경우는 분리되어 있는 것이 더 낫다.

relationship에 attribute를 붙이냐 아니면 entity를 쓰냐는 중요하지 않다. 근데 편리해서 쓰는 것일 뿐이다.

![DB4_5](https://user-images.githubusercontent.com/43085342/55804201-cf7d1500-5b16-11e9-9d58-7bdbe4868e7a.PNG)

**Converting Multiway Relationships to Binary**

data model인 UML, ODL의 경우 relationship이 항상 binary여야만 한다. 그래서 binary 형태로 바꿔야 하는데 contract를 기준으로 movie, star, studio로 연결되는 relationship을 새로 만들어서 서로를 연결하는 다리로 사용하면 된다. contract는 relationship에서 entity로 바꾸고.

**Subclasses in the E/R Model**

subclass = special case = fewer entities = more properties.

예를 들어 학생은 학번을 가지고 있지만 군필인 학생은 군번도 가지고 있다. 이 학생은 special한 case다. 또 다른 예로는 새 책과 중고책이 있다. 새 책이 가지고 있는 정보 + 이전 사용자의 정보까지 가지고 있다면 중고책인 것이드아아아아. 세모로 isa를 표시해서 사용한다.

![DB4_6](https://user-images.githubusercontent.com/43085342/55978666-43f8b500-5ccb-11e9-9a82-826ce86db3d1.PNG)

다른 예시로는 영화가 있다. 카툰의 경우는 성우의 목소리가, 미스테리의 경우는 살인에 사용한 무기가 보통 영화에 비해 더 추가가 된다. 그러면 카툰이면서 미스테리인 경우에는 attribute가 movie에 있는 4가지에 voice, weapon이 더해져 4개가 된다.

Subclasses를 relation으로 바꾸는 방법에는 3가지가 있다.

* E/R style
* Object-oriented: 각각의 class가 entity를 가진다. 모든 attribute를 그 클래스에 다 넣는다.
* Use nulls

사실 이해하기 어려우니까 예시가 직빵이다.

![DB4_7](https://user-images.githubusercontent.com/43085342/55979048-37289100-5ccc-11e9-8330-ee36a2ccc781.PNG)

중고책이라는 subclass에 대한 E/R Diagram이다. 이를 위에 나타난 3가지를 적용해서 relation을 만들면 아래와 같다.

![DB4_8](https://user-images.githubusercontent.com/43085342/55979125-6b03b680-5ccc-11e9-8d8d-1195f29a67b3.PNG)



### 2. Design Principle

5가지의 원칙

* Faithfulness: 현실에 있을만한 거로
* Avoiding Redundancy: 중복은 피하자
* Silplicity Count: 진짜 필요한 element만
* Choosing the Right Relationships
* Picking the Right Kind of Element







**Question**

1. relationship의 attribute를 entity set에 옮길 수 있는 것처럼 반대도 될텐데 그럼 studio도 제거 가능한가요??
2. 